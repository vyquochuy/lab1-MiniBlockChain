[run_all_test] Writing console output to logs\run_all_test_output.txt

================================================================================
BLOCKCHAIN LAYER 1 - COMPREHENSIVE TEST SUITE
================================================================================


================================================================================
Running test_crypto
================================================================================

================================================================================
RUNNING CRYPTOGRAPHY UNIT TESTS
================================================================================

TEST: KeyPair Generation

############################################################
CRYPTO DIAGNOSTICS: keypair_generation
############################################################
 public_key (base64): q5BwgZq8U/5VhSasPhDjah265KG8QohNP4PE1eYnbpY=
 public_key_len: 32 bytes
 address: q5BwgZq8U/5VhSasPhDjah265KG8QohNP4PE1eYnbpY=
PASSED: KeyPair generation works correctly

TEST: Signature Verification

############################################################
CRYPTO DIAGNOSTICS: signature_verification
############################################################
 public_key (base64): s0rTnzPSQtTR4PxHn/E2yfzfxpl07XW7kmfOrzcSqQw=
 public_key_len: 32 bytes
 address: s0rTnzPSQtTR4PxHn/E2yfzfxpl07XW7kmfOrzcSqQw=
 signature (base64): GeQ0RhRYRpqac76VDG6LpaTJOfhuL1cOMhm5vA06H/ONk3Ik7nPcGKo1MwUQ00WC8HpF22iALBOD2fceVGQ4Dw==
 signature_len: 64 bytes
 verified_correct: False
PASSED: Signature verification works correctly

TEST: Domain Separation

############################################################
CRYPTO DIAGNOSTICS: domain_separation
############################################################
 public_key (base64): iME+7lWPYZ1gu05zzpEpOIBrj8/jqm42m9tAe1xoSMg=
 public_key_len: 32 bytes
 address: iME+7lWPYZ1gu05zzpEpOIBrj8/jqm42m9tAe1xoSMg=
 tx_signature: b'\xc4k@A\xe8\xdfd\x18:h\xd4n.\xae~\xd4\xbf\\>\xdb\xa3V\xdd\xb8\xccF\xb6\x99\x11\xb0\x05;s\xd6\xb80\x8b3&\xcc\xfb\xcb\xea\xbaU\x9a.=K/\x8b\\\xbc\xe5\xdd\x99\xd1\x1c\x8e@\xa0\xc3C\x0e'
 vote_signature: b"\x96t\xb1\xc8\x02lf\xc7!\xc0\x03\xb8q\xb2\xff\x9ce'\x7f\x9b\xe0\xfadj\xa4\xfa\xdfX(e\\b\x0c-6\x86/0pU\xa0\x8e\xfd\xa2K-\xc78o1\r\xda4\x8d\xe00\x131\xcb\x10\xccOl\x0b"
 tx_sig_b64: xGtAQejfZBg6aNRuLq5+1L9cPtujVt24zEa2mRGwBTtz1rgwizMmzPvL6rpVmi49Sy+LXLzl3ZnRHI5AoMNDDg==
 vote_sig_b64: lnSxyAJsZschwAO4cbL/nGUnf5vg+mRqpPrfWChlXGIMLTaGLzBwVaCO/aJLLcc4bzEN2jSN4DATMcsQzE9sCw==
 tx_verified: True
 vote_verified: True
PASSED: Domain separation prevents signature reuse

TEST: Deterministic Hashing

############################################################
CRYPTO DIAGNOSTICS: deterministic_hashing
############################################################
 hash1: 7ecf5410de0ed9f632d3dd406555686ad4c8f11d83f97006f0b63b73eb7aa5a2
 hash4: 7ecf5410de0ed9f632d3dd406555686ad4c8f11d83f97006f0b63b73eb7aa5a2
 hash5: 8042defe51d8788dc33f27390dfd46dd3fa6880315ca3dc64c308d50e3e85cdb
PASSED: Hashing is deterministic and collision-resistant

TEST: Chain ID Separation
PASSED: Chain ID separation prevents cross-chain replay

TEST: Message Serialization

############################################################
CRYPTO DIAGNOSTICS: serialization
############################################################
 public_key (base64): Q+QhGq42qKkjKLJrTQ8n2DYU8IMXEjGX8GSMrWBw6nM=
 public_key_len: 32 bytes
 address: Q+QhGq42qKkjKLJrTQ8n2DYU8IMXEjGX8GSMrWBw6nM=
 signature (base64): xCus9AbXGioDIIWYbcLrNo6pQCiacKfWiD5ExuXtzKb7/HlNJx57pgoU3eD0GgXBmlnqpyWFrODLc5LR+HoeDg==
 signature_len: 64 bytes
 signature_b64 (provided): xCus9AbXGioDIIWYbcLrNo6pQCiacKfWiD5ExuXtzKb7/HlNJx57pgoU3eD0GgXBmlnqpyWFrODLc5LR+HoeDg==
 dict keys: ['domain', 'chain_id', 'data', 'signature', 'signer_address']
  domain: TX
  chain_id: test-chain
  data: {'key': 'value', 'number': 123}
  signature: xCus9AbXGioDIIWYbcLrNo6pQCiacKfWiD5ExuXtzKb7/HlNJx57pgoU3eD0GgXBmlnqpyWFrODLc5LR+HoeDg==
  signer_address: Q+QhGq42qKkjKLJrTQ8n2DYU8IMXEjGX8GSMrWBw6nM=
PASSED: Message serialization preserves integrity

TEST: Tamper Detection

############################################################
CRYPTO DIAGNOSTICS: tamper_detection
############################################################
 public_key (base64): GXygLkUtK886BVk/rFPZu7QruCl8OVCz0hSXb2GcLCs=
 public_key_len: 32 bytes
 address: GXygLkUtK886BVk/rFPZu7QruCl8OVCz0hSXb2GcLCs=
 original_signature: b'\x86\xc1\xf6\xeb2 h\x17\xdc7#\x14\x11S;\xf8\xd2\xe9\x19w\xcc\x95P\xce\xb7\x11\x88"\xca\xd0{#\xdf\xcb\xf6ZmRH\xb7%G\xeeRh\x00\xdf\xe0k\x1f\xcd.\xc9P\xda\xef\xe1\x97\xae\xca\x03\xa96\x08'
 tampered_signature: b'\x86\xc1\xf6\xeb2 h\x17\xdc7#\x14\x11S;\xf8\xd2\xe9\x19w\xcc\x95P\xce\xb7\x11\x88"\xca\xd0{#\xdf\xcb\xf6ZmRH\xb7%G\xeeRh\x00\xdf\xe0k\x1f\xcd.\xc9P\xda\xef\xe1\x97\xae\xca\x03\xa96\x08'
 original_sig_b64: hsH26zIgaBfcNyMUEVM7+NLpGXfMlVDOtxGIIsrQeyPfy/ZabVJItyVH7lJoAN/gax/NLslQ2u/hl67KA6k2CA==
PASSED: Data tampering is detected

================================================================================
CRYPTOGRAPHY TEST SUMMARY
================================================================================
PASSED: test_keypair_generation
PASSED: test_signature_verification
PASSED: test_domain_separation
PASSED: test_deterministic_hashing
PASSED: test_chain_id_separation
PASSED: test_serialization
PASSED: test_tamper_detection

ALL CRYPTOGRAPHY TESTS PASSED!

================================================================================
Running test_execution
================================================================================

================================================================================
RUNNING EXECUTION UNIT TESTS
================================================================================

TEST: State Operations

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: state_operations
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 state_hash: 9874854240b45b4bdbf43fca6110bafce8525aedbeca5babaee0cb137d9a7868
 balances: {}

PASSED: State operations work correctly

TEST: Balance Operations

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: balance_operations
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 state_hash: df8926f6597821e4cc615f60afd620cb3f2a102fa6a01261028a018958795e35
 balances: {'alice': 700, 'bob': 800}

PASSED: Balance operations work correctly

TEST: State Hash Determinism

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: state_hash_determinism
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 state_hash: 347363fca0763b956b4b8ef20bfc758a9af6ec85d348db871879924016dc7e70
 balances: {'alice': 1000, 'bob': 2000}

PASSED: State hashing is deterministic

TEST: Transaction Creation

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: transaction_creation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 transactions_count: 1

PASSED: Transaction creation works correctly

TEST: Transaction Nonce (Replay Protection)

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: transaction_nonce
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 state_hash: 46d44bceea7755e1b0d2ca48f6f0ef19f8849d331ca1e85b76eadfed3e035e56
 balances: {'llXmYuAPcfhyrmFMomuVBJvndT/vrdpPoCp6Kvz1c68=': 800, 'recipient': 200}
 processed_nonces: {'llXmYuAPcfhyrmFMomuVBJvndT/vrdpPoCp6Kvz1c68=': 2}

PASSED: Nonce prevents replay attacks

TEST: Transaction Signature Validation

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: transaction_signature_validation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

PASSED: Invalid signatures are rejected

TEST: Executor Determinism

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: executor_determinism
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 state_hash: 7c95b484949198e3b1414af251c75c7ff628cb7674e6251bfd17f1ff1c99aa37
 balances: {'fzEG5Jdf9Rq60ZNEeD19n/3pVFwQli3DwXR6hCmQook=': 850, 'recipient_0': 10, 'recipient_1': 20, 'recipient_2': 30, 'recipient_3': 40, 'recipient_4': 50}
 processed_nonces: {'fzEG5Jdf9Rq60ZNEeD19n/3pVFwQli3DwXR6hCmQook=': 5}
 transactions_count: 5
 executed: ['34477500f95d2ae436f5611619d51d072518529f2829c573b972c848a7c6b5f3', 'fdbfd7f7905d6adc46f3ec17a398a77cdc59c7849d8f2097417a7c91ce9f6b91', '9fc72134a165003ff64b7989e2fd822f34753e26ab1f49037e4a7c67e21dabdc', '1d6283c33683962a19f0f93a7120415c743a5a635065963bb6f64ca206392c7f', 'b93e60e8a89ae8fd80b938e3c01cf291e52984f76d8cff1a79c3796bfe5056ea']

PASSED: Executor is deterministic

TEST: Insufficient Balance Check

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: insufficient_balance
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 state_hash: 5f1dedaae4570365d7a5c749dd63e318faf0a61bac62aaf502058181073ffec5
 balances: {'Uj8SI/vAsHw9yVS9z5+ujWP8EIAENdh/J+2fsfrua3I=': 50}
 processed_nonces: {}
 last_error: Insufficient balance. Has 50, needs 100

PASSED: Insufficient balance is checked

TEST: State Isolation

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: state_isolation_original
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 state_hash: 14080b5311a1c622d7f39681bf75f90b6739d29f08d48f160b4fb8ae561cc3fd
 balances: {'alice': 1000}


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: state_isolation_copy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 state_hash: 7cbfc0c598b5b573608d18c23548d74007d38b837a3c4adf3127844458ee1437
 balances: {'alice': 2000, 'bob': 500}

PASSED: State copies are isolated

TEST: Transaction Ordering

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EXECUTION DIAGNOSTICS: transaction_ordering
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 state_hash: bff8296c98bba13b7a2db3351fb6e34fafb0152bb2081db9c05cac7ca15e8dcf
 balances: {'6Zbn31boIes6KhRqU2H9pJqFXOno1T/ZjfQkbN/zcI0=': 200, '9fPKy1sbItyG/0fCIWvj9mLy5Q3JzFUNh+3jvReIWsA=': 800}
 processed_nonces: {'6Zbn31boIes6KhRqU2H9pJqFXOno1T/ZjfQkbN/zcI0=': 2}
 executed: ['f949b774090e8ccc708eb7d85ee0ad12c8fab0d435b3e801bad2c072168c5da5', '237022220da1cbea9876713b01898a1c87f046d96956ac308cd4fd650d03eaaf']

PASSED: Transaction ordering is respected

================================================================================
EXECUTION TEST SUMMARY
================================================================================
PASSED: test_state_operations
PASSED: test_balance_operations
PASSED: test_state_hash_determinism
PASSED: test_transaction_creation
PASSED: test_transaction_nonce
PASSED: test_transaction_signature_validation
PASSED: test_executor_determinism
PASSED: test_insufficient_balance
PASSED: test_state_isolation
PASSED: test_transaction_ordering

ALL EXECUTION TESTS PASSED!

================================================================================
Running test_consensus
================================================================================

================================================================================
RUNNING CONSENSUS UNIT TESTS
================================================================================

TEST: Vote Creation and Verification
PASSED: Vote creation and verification works

TEST: Vote Collector

================================================================================
CONSENSUS DIAGNOSTICS: after_adding_prevotes
================================================================================
 total_validators: 4
 prevotes:
   height=1, block=abc123..., voters=3 -> ['5F1bhk+aNdsTTIz74CaBcMmW8719Z6J8RF+gmFXixBs=', 'GEVLYuMUGYLIl+WAwNohrxYS5Z4cA8bXJqyGwdazFTk=', 'QP1VDMfKdoyHv1gAV/BTPU5SYDdG82y8ewjdPLVyWb0=']
 precommits:
 height=1: prevotes={'abc123': 3}, precommits={}

PASSED: Vote collector tracks majorities correctly

TEST: Duplicate Vote Rejection
PASSED: Duplicate votes are rejected

TEST: Block Header Hash Consistency
PASSED: Block header hashing is consistent

TEST: Block Serialization
PASSED: Block serialization preserves data

TEST: Genesis Block Creation
PASSED: Genesis block created correctly

TEST: Two-Phase Voting Process

================================================================================
CONSENSUS DIAGNOSTICS: after_prevotes_two_phase
================================================================================
 total_validators: 4
 prevotes:
   height=1, block=block123..., voters=3 -> ['nDca7dd+ljxl9klOqkKqeLrflbqGMPhNl1uFtPDpNrU=', 'jCZ9VxpBo3jHKEuX6EgQy0RUY0jAQI/JUEKDWCbwVoY=', '0Xx511YZDxLD4NLqMpw6iwHvxUO8ecpFWJ9d3djcgRk=']
 precommits:
 height=1: prevotes={'block123': 3}, precommits={}


================================================================================
CONSENSUS DIAGNOSTICS: after_precommits_two_phase
================================================================================
 total_validators: 4
 prevotes:
   height=1, block=block123..., voters=3 -> ['nDca7dd+ljxl9klOqkKqeLrflbqGMPhNl1uFtPDpNrU=', 'jCZ9VxpBo3jHKEuX6EgQy0RUY0jAQI/JUEKDWCbwVoY=', '0Xx511YZDxLD4NLqMpw6iwHvxUO8ecpFWJ9d3djcgRk=']
 precommits:
   height=1, block=block123..., voters=3 -> ['nDca7dd+ljxl9klOqkKqeLrflbqGMPhNl1uFtPDpNrU=', 'jCZ9VxpBo3jHKEuX6EgQy0RUY0jAQI/JUEKDWCbwVoY=', '0Xx511YZDxLD4NLqMpw6iwHvxUO8ecpFWJ9d3djcgRk=']
 height=1: prevotes={'block123': 3}, precommits={'block123': 3}

PASSED: Two-phase voting process works correctly

TEST: Conflicting Votes

================================================================================
CONSENSUS DIAGNOSTICS: after_conflicting_votes
================================================================================
 total_validators: 3
 prevotes:
   height=1, block=block1..., voters=1 -> ['dGIQ0xI/7tkydMKaAM6h9gqk3UqmB0JLPe5IPszKcTw=']
   height=1, block=block2..., voters=1 -> ['dGIQ0xI/7tkydMKaAM6h9gqk3UqmB0JLPe5IPszKcTw=']
 precommits:
 height=1: prevotes={'block1': 1, 'block2': 1}, precommits={}

PASSED: Conflicting votes are tracked separately

TEST: ConsensusEngine Diagnostics

================================================================================
CONSENSUS DIAGNOSTICS: engine_after_receive_proposal
================================================================================
 total_validators: 4
 prevotes:
   height=1, block=7025d389..., voters=1 -> ['fsWaAHpCoR0uVRUWNgRy4QmH5/FgtihA2YdFAK/C6qc=']
 precommits:
 height=1: prevotes={'7025d389f255b50676ebd27170ed53881048801955c44b389aa50f9793b136be': 1}, precommits={}


================================================================================
CONSENSUS DIAGNOSTICS: engine_after_external_prevotes
================================================================================
 total_validators: 4
 prevotes:
   height=1, block=7025d389..., voters=3 -> ['fsWaAHpCoR0uVRUWNgRy4QmH5/FgtihA2YdFAK/C6qc=', 'ZuNN0CCaq+IGvfUEj6L7WB6d8i5eqm2NqtLBfQkpX8A=', 'FpjoYG9VcE3Vy+9i50+VpCwoHrTM24HijhUrVNR4ypA=']
 precommits:
   height=1, block=7025d389..., voters=1 -> ['fsWaAHpCoR0uVRUWNgRy4QmH5/FgtihA2YdFAK/C6qc=']
 height=1: prevotes={'7025d389f255b50676ebd27170ed53881048801955c44b389aa50f9793b136be': 3}, precommits={'7025d389f255b50676ebd27170ed53881048801955c44b389aa50f9793b136be': 1}

PASSED: ConsensusEngine diagnostics

================================================================================
CONSENSUS TEST SUMMARY
================================================================================
PASSED: test_vote_creation_and_verification
PASSED: test_vote_collector
PASSED: test_duplicate_vote_rejection
PASSED: test_block_header_hash
PASSED: test_block_serialization
PASSED: test_genesis_block_creation
PASSED: test_two_phase_voting
PASSED: test_conflicting_votes
PASSED: test_consensus_engine_diagnostics

ALL CONSENSUS TESTS PASSED!

================================================================================
Running test_network
================================================================================

================================================================================
RUNNING NETWORK UNIT TESTS
================================================================================

TEST: Basic Message Delivery
PASSED: Messages are delivered correctly

TEST: Message Delays
PASSED: Messages are properly delayed

TEST: Packet Loss
--- NETWORK CONFIG ---
  loss_rate: 0.5
  delay_range: (0.001, 0.01)
  duplicate_rate: 0.0
  enable_delays: False
  num_messages: 100
--- NETWORK STATS ---
  delivered: 0
  dropped: 59
  duplicated: 0
  pending: 41
  in_inboxes: 0
  simulation_time: 0.0
  blocked_peers: 0
  rate_limited_drops: 0
  rate_limit_drops: 0
  Calculated loss rate: 59.00% (expected ~50%)
PASSED: Packet loss rate: 59.00%

TEST: Message Duplicates
PASSED: Message duplication works

TEST: Message Broadcasting
PASSED: Broadcasting works correctly

TEST: Message Reordering
   Messages were reordered: [8, 3, 5, 0, 6]...
PASSED: Message reordering can occur

TEST: Network Statistics
--- NETWORK CONFIG ---
  delay_range: (0.001, 0.01)
  loss_rate: 0.2
  duplicate_rate: 0.1
  enable_delays: False
  num_messages: 50
--- NETWORK STATS ---
  delivered: 41
  dropped: 13
  duplicated: 4
  pending: 0
  in_inboxes: 0
  simulation_time: 0.02
  blocked_peers: 0
  rate_limited_drops: 0
  rate_limit_drops: 0
PASSED: Network statistics tracked correctly

TEST: Zero Delay Mode
PASSED: Zero-delay mode works for testing

TEST: Rate Limiting - Blocking Excessive Senders
   Dropped 50 messages due to rate limit
   Alice blocked: {'alice'}
PASSED: Rate limiting blocks excessive senders

TEST: Rate Limiting - Peer Unblocking After Timeout
   Alice was blocked until time: 5.00
   Current simulation time: 6.01
PASSED: Blocked peers are unblocked after timeout

TEST: Rate Limiting - Per-Sender Enforcement
   Alice blocked: Yes
   Bob blocked: No
   Bob's messages delivered: 50/50
PASSED: Rate limiting is enforced per-sender

TEST: Rate Limiting - Statistics Tracking
--- NETWORK CONFIG ---
  delay_range: (0.001, 0.01)
  loss_rate: 0.0
  duplicate_rate: 0.0
  enable_delays: False
  num_messages: 150
--- NETWORK STATS ---
  delivered: 0
  dropped: 50
  duplicated: 0
  pending: 100
  in_inboxes: 0
  simulation_time: 0.0
  blocked_peers: 1
  rate_limited_drops: 50
  rate_limit_drops: 50
   Blocked peers: 1
   Rate limited drops: 50
   Total dropped: 50
PASSED: Rate limiting statistics tracked correctly

TEST: Header/Body Separation - Basic Functionality
--- TEST CONFIG ---
  chain_id: test-chain
  num_validators: 3
  tx_amount: 50
--- NODE[0] HEADER/BODY STATS ---
  pending_block_bodies: 1
  accepted_headers: 1
  requested_bodies: 0
   Leader has header/body separation structures
   Pending block bodies: 1
PASSED: Basic header/body separation structures exist

TEST: Header/Body Separation - Message Type Handling
   Node has _handle_block_header()
   Node has _handle_block_body_request()
   Node has _handle_block_body()
PASSED: Header/body message handlers exist

TEST: Header/Body Separation - Backward Compatibility
   Blocks finalized: 1
PASSED: Backward compatibility maintained

================================================================================
NETWORK TEST SUMMARY
================================================================================
PASSED: test_message_delivery
PASSED: test_message_delays
PASSED: test_packet_loss
PASSED: test_message_duplicates
PASSED: test_broadcast
PASSED: test_message_reordering
PASSED: test_network_stats
PASSED: test_zero_delay_mode
PASSED: test_rate_limiting
PASSED: test_rate_limit_peer_unblocking
PASSED: test_rate_limit_multiple_senders
PASSED: test_rate_limit_stats
PASSED: test_header_body_separation_basic
PASSED: test_header_body_message_types
PASSED: test_header_body_backward_compatibility

ALL NETWORK TESTS PASSED!
Total tests: 15
  - Original tests: 8
  - Rate limiting tests: 4
  - Header/Body tests: 3

================================================================================
Running test_e2e
================================================================================

================================================================================
RUNNING END-TO-END TESTS
================================================================================

================================================================================
TEST: Single Block Finalization
================================================================================

--------------------------------------------------------------------------------
DIAGNOSTICS: single_block_running @ tick=0
--------------------------------------------------------------------------------
Network stats:
  simulation_time: 0.01
  delivered: 3
  dropped: 0
  duplicated: 0
  pending (message_queue): 9
  in_inboxes: 0
  blocked_peers: 0
  rate_limited_drops: 0

Node states:
  Node[0] WXIiNv/T...: chain_len=1, height=1, tx_pool=0, last_block=db10643e3ae41461, prevoted=1, precommitted=0
  Node[1] AxPH0f+5...: chain_len=1, height=1, tx_pool=1, last_block=db10643e3ae41461, prevoted=0, precommitted=0
  Node[2] ujeIkvZx...: chain_len=1, height=1, tx_pool=1, last_block=db10643e3ae41461, prevoted=0, precommitted=0
  Node[3] naQbUD6o...: chain_len=1, height=1, tx_pool=1, last_block=db10643e3ae41461, prevoted=0, precommitted=0

--------------------------------------------------------------------------------
DIAGNOSTICS: single_block_running @ tick=20
--------------------------------------------------------------------------------
Network stats:
  simulation_time: 0.21000000000000005
  delivered: 56
  dropped: 0
  duplicated: 4
  pending (message_queue): 0
  in_inboxes: 0
  blocked_peers: 0
  rate_limited_drops: 0

Node states:
  Node[0] WXIiNv/T...: chain_len=2, height=2, tx_pool=0, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[1] AxPH0f+5...: chain_len=2, height=2, tx_pool=0, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[2] ujeIkvZx...: chain_len=2, height=2, tx_pool=1, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[3] naQbUD6o...: chain_len=2, height=2, tx_pool=1, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1

--------------------------------------------------------------------------------
DIAGNOSTICS: single_block_running @ tick=40
--------------------------------------------------------------------------------
Network stats:
  simulation_time: 0.4100000000000002
  delivered: 56
  dropped: 0
  duplicated: 4
  pending (message_queue): 0
  in_inboxes: 0
  blocked_peers: 0
  rate_limited_drops: 0

Node states:
  Node[0] WXIiNv/T...: chain_len=2, height=2, tx_pool=0, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[1] AxPH0f+5...: chain_len=2, height=2, tx_pool=0, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[2] ujeIkvZx...: chain_len=2, height=2, tx_pool=1, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[3] naQbUD6o...: chain_len=2, height=2, tx_pool=1, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1

--------------------------------------------------------------------------------
DIAGNOSTICS: single_block_running @ tick=60
--------------------------------------------------------------------------------
Network stats:
  simulation_time: 0.6100000000000003
  delivered: 56
  dropped: 0
  duplicated: 4
  pending (message_queue): 0
  in_inboxes: 0
  blocked_peers: 0
  rate_limited_drops: 0

Node states:
  Node[0] WXIiNv/T...: chain_len=2, height=2, tx_pool=0, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[1] AxPH0f+5...: chain_len=2, height=2, tx_pool=0, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[2] ujeIkvZx...: chain_len=2, height=2, tx_pool=1, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[3] naQbUD6o...: chain_len=2, height=2, tx_pool=1, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1

--------------------------------------------------------------------------------
DIAGNOSTICS: single_block_running @ tick=80
--------------------------------------------------------------------------------
Network stats:
  simulation_time: 0.8100000000000005
  delivered: 56
  dropped: 0
  duplicated: 4
  pending (message_queue): 0
  in_inboxes: 0
  blocked_peers: 0
  rate_limited_drops: 0

Node states:
  Node[0] WXIiNv/T...: chain_len=2, height=2, tx_pool=0, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[1] AxPH0f+5...: chain_len=2, height=2, tx_pool=0, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[2] ujeIkvZx...: chain_len=2, height=2, tx_pool=1, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
  Node[3] naQbUD6o...: chain_len=2, height=2, tx_pool=1, last_block=a1b3b8d24617f72b, prevoted=1, precommitted=1
PASSED: Single block finalized correctly

================================================================================
TEST: No Double Finalization (Safety)
================================================================================

--------------------------------------------------------------------------------
DIAGNOSTICS: no_double_finalization_running @ tick=0
--------------------------------------------------------------------------------
Network stats:
  simulation_time: 0.01
  delivered: 10
  dropped: 3
  duplicated: 0
  pending (message_queue): 8
  in_inboxes: 0
  blocked_peers: 0
  rate_limited_drops: 0

Node states:
  Node[0] 0XX4KL/k...: chain_len=1, height=1, tx_pool=0, last_block=7804ef1dfc0ba725, prevoted=1, precommitted=0
  Node[1] VrNqWMOp...: chain_len=1, height=1, tx_pool=3, last_block=7804ef1dfc0ba725, prevoted=0, precommitted=0
  Node[2] 1xcwy9Wv...: chain_len=1, height=1, tx_pool=4, last_block=7804ef1dfc0ba725, prevoted=0, precommitted=0
  Node[3] BANNuGHE...: chain_len=1, height=1, tx_pool=4, last_block=7804ef1dfc0ba725, prevoted=0, precommitted=0

--------------------------------------------------------------------------------
DIAGNOSTICS: no_double_finalization_running @ tick=50
--------------------------------------------------------------------------------
Network stats:
  simulation_time: 0.5100000000000002
  delivered: 56
  dropped: 7
  duplicated: 4
  pending (message_queue): 0
  in_inboxes: 0
  blocked_peers: 0
  rate_limited_drops: 0

Node states:
  Node[0] 0XX4KL/k...: chain_len=2, height=2, tx_pool=0, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
  Node[1] VrNqWMOp...: chain_len=2, height=2, tx_pool=0, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
  Node[2] 1xcwy9Wv...: chain_len=2, height=2, tx_pool=4, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
  Node[3] BANNuGHE...: chain_len=2, height=2, tx_pool=4, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1

--------------------------------------------------------------------------------
DIAGNOSTICS: no_double_finalization_running @ tick=100
--------------------------------------------------------------------------------
Network stats:
  simulation_time: 1.0100000000000007
  delivered: 56
  dropped: 7
  duplicated: 4
  pending (message_queue): 0
  in_inboxes: 0
  blocked_peers: 0
  rate_limited_drops: 0

Node states:
  Node[0] 0XX4KL/k...: chain_len=2, height=2, tx_pool=0, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
  Node[1] VrNqWMOp...: chain_len=2, height=2, tx_pool=0, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
  Node[2] 1xcwy9Wv...: chain_len=2, height=2, tx_pool=4, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
  Node[3] BANNuGHE...: chain_len=2, height=2, tx_pool=4, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1

--------------------------------------------------------------------------------
DIAGNOSTICS: no_double_finalization_running @ tick=150
--------------------------------------------------------------------------------
Network stats:
  simulation_time: 1.5100000000000011
  delivered: 56
  dropped: 7
  duplicated: 4
  pending (message_queue): 0
  in_inboxes: 0
  blocked_peers: 0
  rate_limited_drops: 0

Node states:
  Node[0] 0XX4KL/k...: chain_len=2, height=2, tx_pool=0, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
  Node[1] VrNqWMOp...: chain_len=2, height=2, tx_pool=0, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
  Node[2] 1xcwy9Wv...: chain_len=2, height=2, tx_pool=4, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
  Node[3] BANNuGHE...: chain_len=2, height=2, tx_pool=4, last_block=20edc6db22f6e1d4, prevoted=1, precommitted=1
PASSED: No double finalization detected (Safety guaranteed)

================================================================================
TEST: Invalid Signature Rejection
================================================================================
PASSED: Invalid signatures rejected

================================================================================
TEST: Deterministic Replay
================================================================================
PASSED: Deterministic replay produces identical results

================================================================================
TEST SUMMARY
================================================================================
PASSED: test_single_block_finalization
PASSED: test_no_double_finalization
PASSED: test_invalid_signature_rejection
PASSED: test_deterministic_replay

ALL TESTS PASSED!

================================================================================
FINAL TEST REPORT
================================================================================

PASSED - test_crypto          (0.02s)
PASSED - test_execution       (0.02s)
PASSED - test_consensus       (0.01s)
PASSED - test_network         (0.03s)
PASSED - test_e2e             (0.14s)

================================================================================
Total Duration: 0.30s
================================================================================

ALL TEST SUITES PASSED!

Test report saved to logs/test_report.json

Text output saved to logs\run_all_test_output.txt
